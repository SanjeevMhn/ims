<div class="wrapper relative text-[62.5%] h-screen w-full flex flex-col">
  <app-calendar
    (showEventOutput)="showEvent($event)"
    (showAddEventFormOutput)="showAddEventForm($event)"
    class="contents"
  />
  <!-- <div class="flex h-full"> -->
  <!-- <div class="frozon-column h-full border-[#adadad] border-l border-t border-b z-50">
        <table class="calendar-table">
            <thead class="sticky top-0 h-[7.3em] border-[#adadad] border-b">
                <tr>
                    <th  class="sticky left-0">Supplier</th>
                    <th class="align-middle sticky left-[7em]">Product</th>
                </tr>
            </thead>
            <tbody>
            @for(delivery of supplierDelivery; track delivery.id){
                <tr class="main-tr">
                    <td class="border-0! border-b! sticky left-0">{{delivery.supplier_name}}</td>
                    <td class="p-0! border-0! sticky left-[7em]">
                        <table class="text-[62.5%] w-full">
                            @for(product of delivery.supplier_products; track product.id){
                                <tr>
                                    <td class="border-0! border-l! border-b!">{{product.product_name}}</td>
                                </tr>
                            }
                        </table> 
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div> -->
  <!-- <div class="table-container w-full overflow-y-auto h-full" [class]="animateTable() ? 'move' : ''">
        <table class="calendar-table w-full">
            <thead class="sticky top-0">
                <tr>
                    <th rowspan="2" class="sticky left-0 sticky-th">Supplier</th>
                    <th rowspan="2" class="align-middle sticky left-[7em] sticky-th">Product</th>
                    <td rowspan="2" class="p-0! border-0!" [attr.colspan]="weeks.length + 1">
                        <table class="w-full h-full text-[62.5%]">
                            <td [attr.colspan]="weeks.length" class="p-0! border-0!">
                                <table class="w-full h-full text-[62.5%]">
                                    <tr>
                                        @for(week of weeks; track $index){
                                        <td
                                            [class.text-neutral-400]="!week.is_current"
                                            class="border-0! border-b! border-r! font-medium text-center min-w-[5em] uppercase"
                                        >
                                            {{ week == null ? $index + 1 : week.dayName }}
                                        </td>
                                        }
                                    </tr>
                                    <tr>
                                        @for(week of weeks; track $index){
                                        <td
                                            [class.text-neutral-400]="!week.is_current"
                                            class="border-0! border-r! border-b! min-w-[5em] font-semibold text-center text-[1.8em]!"
                                        >
                                            {{ week == null ? $index + 1 : week.dayIndex }}
                                        </td>
                                        }
                                    </tr>
                                
                                </table>
                            </td>
                        </table>
                    </td>
                </tr>
            </thead>
            <tbody>
                @for(delivery of supplierDelivery; track delivery.id){
                    <tr class="main-tr">
                        <td class="border-0! border-b! sticky left-0">{{delivery.supplier_name}}</td>
                        <td class="p-0! border-0! sticky left-[7em]">
                            <table class="text-[62.5%] w-full">
                                @for(product of delivery.supplier_products; track product.id){
                                    <tr>
                                        <td class="border-0! border-l! border-r! border-b!">{{product.product_name}}</td>
                                    </tr>
                                }
                            </table> 
                        </td>
                        <td class="p-0! border-0!" [attr.colspan]="weeks.length + 2">
                            <table class="text-[62.5%] w-full">
                                @for(product of delivery.supplier_products; track product.id){
                                    <tr>
                                        @for(week of weeks; track $index){
                                            <td class="h-[2.5em] max-h-[3.5em] border-0! border-l! border-b! w-[3.5em] data-td">
                                                @for(supp of supplierDelivery; track supp.id){
                                                    @for(delivery of supp.delivery; track delivery.id){
                                                        @if(delivery.delivery_date == week.fullDate && delivery.delivery_product == product.product_name){
                                                            {{delivery.delivery_product_amount}}
                                                        }
                                                    }
                                                }
                                            </td>
                                        }
                                    </tr>
                                }
                            </table>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div> -->
  <!-- </div>  -->

  <dialog class="event-dialog" #eventDialog (close)="resetForm()">
    <form [formGroup]="addEventForm" class="form bg-[#1e1f20]! relative text-white" (submit)="addEvent($event)">
      <button type="button" class="icon-container ml-auto cursor-pointer" (click)="closeForm()">
        <lucide-angular [img]="closeIcon" />
      </button>
      @if(fromCreateButton){
      <div class="form-group">
        <label for="date" class="form-label">From Date</label>
        <input type="date" name="date" id="date" class="form-control text-black!" formControlName="from_date" />
      </div>
      <div class="form-group">
        <label for="date" class="form-label">To Date</label>
        <input type="date" name="date" id="date" class="form-control text-black!" formControlName="to_date" />
      </div>
      }@else{
      <div class="form-group flex-row!">
        <label for="" class="form-label">Date:</label>
        <p class="text-[1.6em]">
          {{ selectedDate ? formatDateByMonthAndDayName(selectedDate) : '' }}
        </p>
      </div>
      }
      <div class="form-group">
        <label for="event" class="form-label">Event Title</label>
        <input
          type="text"
          #eventTitle
          name="event"
          id="event"
          class="form-control text-black!"
          placeholder="Add Title"
          formControlName="event"
        />
        @if(isSubmitted){ @if(addEventForm.get('event')?.invalid &&
        addEventForm.get('event')?.touched){ @if(addEventForm.get('event')?.hasError('required')){
        <small class="text-red-600 text-[1.2em]">Event Title Required</small>
        } @if(addEventForm.get('event')?.hasError('minlength')){
        <small class="text-red-600 text-[1.2em]"
          >Event Title must be atleast 5 characters long</small
        >
        } } }
      </div>
      <div class="form-action">
        <button type="submit" class="btn">Save</button>
      </div>
    </form>
  </dialog>

  <dialog class="event-dialog" #showEventDialog>
    <div class="event-details form bg-[#1e1f20]! gap-[0.5em]! text-white">
      <div class="toolbar flex justify-end gap-[1em]">
        <button type="button" class="icon-container cursor-pointer" (click)="deleteEvent()">
          <lucide-angular [img]="deleteIcon" />
        </button>
        <button type="button" class="icon-contaioner cursor-pointer" (click)="editEvent()">
          <lucide-angular [img]="editIcon" />
        </button>
        <button type="button" class="icon-container cursor-pointer" (click)="closeShowEvent()">
          <lucide-angular [img]="closeIcon" />
        </button>
      </div>
      @if(activeEvent){
      <h2 class="text-[2em] font-medium">{{ activeEvent.title }}</h2>
      <p class="text-[1.6em]">{{ activeEvent.date }}</p>
      }
    </div>
  </dialog>
</div>
<router-outlet />
